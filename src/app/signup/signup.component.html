<div class="center-container">
  <mat-card class="signup-card">
    <mat-card-header>
      <button (click)="navigateToHome()" type="button" aria-label="Back to home" class="back-button">
        <span class="back-label">‚Üê BACK</span>
      </button>
      <div class="header-text">
        <mat-card-title>Create Account</mat-card-title>
        <mat-card-subtitle>Join Spacefinders today</mat-card-subtitle>
      </div>
    </mat-card-header>

    <mat-card-content>
      <div *ngIf="successMessage" class="alert alert-success" role="alert">
        <mat-icon>check_circle_outline</mat-icon>
        <span>{{ successMessage }}</span>
      </div>

      <div *ngIf="errorMessage" class="alert alert-danger" role="alert">
        <mat-icon>error_outline</mat-icon>
        <span>{{ errorMessage }}</span>
      </div>

      <form [formGroup]="signupForm" (ngSubmit)="onSubmit()">

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Username</mat-label>
          <input matInput formControlName="username" placeholder="Enter your username" autocomplete="username" required>
          <mat-error *ngIf="hasError('username')">{{ getErrorMessage('username') }}</mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Email</mat-label>
          <input matInput type="email" formControlName="userMail" placeholder="email@example.com" autocomplete="email" required>
          <mat-error *ngIf="hasError('userMail')">{{ getErrorMessage('userMail') }}</mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Phone Number</mat-label>
          <input matInput type="tel" formControlName="userPhone" placeholder="9876543210" autocomplete="tel" maxlength="10" required>
          <mat-error *ngIf="hasError('userPhone')">{{ getErrorMessage('userPhone') }}</mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Password</mat-label>
          <input matInput [type]="showPassword ? 'text' : 'password'" formControlName="password" placeholder="Enter your password" autocomplete="new-password" required>
          <button mat-icon-button matSuffix type="button" (click)="togglePasswordVisibility()" [attr.aria-label]="showPassword ? 'Hide password' : 'Show password'">
            <span class="toggle-label">{{showPassword ? 'HIDE' : 'SHOW'}}</span>
          </button>
           <mat-error *ngIf="hasError('password') && !password?.errors?.['passwordPattern']">{{ getErrorMessage('password') }}</mat-error>
        </mat-form-field>

         <mat-list dense *ngIf="password?.touched && password?.errors?.['passwordPattern']" class="password-requirements">
           <mat-list-item [class.met]="getPasswordRequirements().hasMinLength">
              <mat-icon matListItemIcon class="requirement-icon">{{ getPasswordRequirements().hasMinLength ? 'check_circle' : 'radio_button_unchecked' }}</mat-icon>
              At least 8 characters
           </mat-list-item>
           <mat-list-item [class.met]="getPasswordRequirements().hasUpperCase">
              <mat-icon matListItemIcon class="requirement-icon">{{ getPasswordRequirements().hasUpperCase ? 'check_circle' : 'radio_button_unchecked' }}</mat-icon>
              One uppercase letter
           </mat-list-item>
           <mat-list-item [class.met]="getPasswordRequirements().hasLowerCase">
              <mat-icon matListItemIcon class="requirement-icon">{{ getPasswordRequirements().hasLowerCase ? 'check_circle' : 'radio_button_unchecked' }}</mat-icon>
              One lowercase letter
            </mat-list-item>
           <mat-list-item [class.met]="getPasswordRequirements().hasNumeric">
              <mat-icon matListItemIcon class="requirement-icon">{{ getPasswordRequirements().hasNumeric ? 'check_circle' : 'radio_button_unchecked' }}</mat-icon>
              One number
            </mat-list-item>
           <mat-list-item [class.met]="getPasswordRequirements().hasSpecialChar">
              <mat-icon matListItemIcon class="requirement-icon">{{ getPasswordRequirements().hasSpecialChar ? 'check_circle' : 'radio_button_unchecked' }}</mat-icon>
              One special character (#$%^&+=)
            </mat-list-item>
        </mat-list>


        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Confirm Password</mat-label>
          <input matInput [type]="showConfirmPassword ? 'text' : 'password'" formControlName="confirmPassword" placeholder="Re-enter your password" autocomplete="new-password" required>
          <button mat-icon-button matSuffix type="button" (click)="toggleConfirmPasswordVisibility()" [attr.aria-label]="showConfirmPassword ? 'Hide password' : 'Show password'">
            <span class="toggle-label">{{showConfirmPassword ? 'HIDE' : 'SHOW'}}</span>
          </button>
          <mat-error *ngIf="hasError('confirmPassword')">{{ getErrorMessage('confirmPassword') }}</mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Address</mat-label>
          <textarea matInput formControlName="userAddress" placeholder="Enter your complete address" rows="3" required></textarea>
          <mat-error *ngIf="hasError('userAddress')">{{ getErrorMessage('userAddress') }}</mat-error>
        </mat-form-field>

        <div class="form-group">
          <mat-radio-group formControlName="userRole" class="role-selection">
            <mat-radio-button *ngFor="let role of userRoles" [value]="role.value" class="role-option">
               <span class="role-icon">{{ role.icon }}</span> {{ role.label }}
            </mat-radio-button>
          </mat-radio-group>
           <mat-error *ngIf="hasError('userRole')">{{ getErrorMessage('userRole') }}</mat-error>
        </div>

        <div class="form-group terms-group">
          <mat-checkbox formControlName="agreeTerms" required color="primary">
            I agree to the <a href="#" class="link">Terms and Conditions</a>
            and <a href="#" class="link">Privacy Policy</a> *
          </mat-checkbox>
          <mat-error *ngIf="hasError('agreeTerms')">You must agree to the terms</mat-error>
        </div>

        <button mat-raised-button color="primary" type="submit" class="full-width submit-button" [disabled]="isLoading || signupForm.invalid">
           <span *ngIf="!isLoading">Create Account</span>
           <span *ngIf="isLoading" style="display: flex; align-items: center; justify-content: center;">
             <mat-spinner diameter="20" style="margin-right: 8px;"></mat-spinner>
             Creating Account...
           </span>
        </button>

        <div class="footer-text">
          Already have an account?
          <button mat-button color="primary" type="button" (click)="navigateToLogin()">
            Login here
          </button>
        </div>
      </form>
    </mat-card-content>
  </mat-card>
</div>

<style>
/* Signup Component Specific Styles */

/* Card container */
.signup-card {
  max-width: 520px;
  width: 100%;
  animation: fadeInUp 0.6s ease-out;
}

@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Card header layout */
mat-card-header {
  display: flex !important;
  align-items: center;
  gap: 12px;
}

.back-button {
  flex-shrink: 0;
  margin: -8px 0 0 -8px;
  color: #bdae93 !important;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
}

.back-button:hover {
  background-color: rgba(142, 192, 124, 0.15) !important;
  color: #8ec07c !important;
}

.header-text {
  flex: 1;
  min-width: 0;
}

/* Form fields */
.full-width {
  width: 100%;
  margin-bottom: 14px;
}

.full-width mat-form-field {
  width: 100%;
}

/* Password requirements list */
.password-requirements {
  background-color: rgba(107, 104, 103, 0.2) !important;
  border-radius: 6px;
  margin: -8px 0 12px 0 !important;
  padding: 8px 12px !important;
}

.password-requirements mat-list-item {
  height: 24px !important;
  padding: 2px 0 !important;
  font-size: 12px !important;
  color: #bdae93 !important;
}

.password-requirements mat-list-item.met {
  color: #b8bb26 !important;
}

.password-requirements .requirement-icon {
  font-size: 14px !important;
  width: 16px !important;
  height: 16px !important;
  margin-right: 8px !important;
  color: inherit !important;
}

.mat-mdc-list-item-icon {
  color: inherit !important;
}

/* Form group styling */
.form-group {
  margin-bottom: 18px;
}

.role-label {
  display: block;
  margin-bottom: 10px;
  font-weight: 600;
  color: #ebdbb2;
  font-size: 14px;
  letter-spacing: 0.3px;
}

.role-selection {
  display: flex;
  gap: 12px;
  flex-wrap: wrap;
}

.role-option {
  flex: 1;
  min-width: 160px;
}

.role-icon {
  margin-right: 6px;
  font-size: 16px;
}

/* Terms checkbox */
.terms-group {
  margin: 24px 0;
  padding: 12px;
  background-color: rgba(107, 104, 103, 0.15);
  border-radius: 6px;
}

.terms-group .mat-mdc-checkbox-label {
  color: #d5c4a1 !important;
  font-size: 13px !important;
}

.link {
  color: #8ec07c !important;
  text-decoration: none;
  font-weight: 500;
  transition: all 0.2s ease;
}

.link:hover {
  color: #a8d890 !important;
  text-decoration: underline;
}

/* Submit button */
.submit-button {
  padding: 12px 24px !important;
  margin-top: 12px;
  margin-bottom: 16px;
  font-size: 15px !important;
  font-weight: 600 !important;
  letter-spacing: 0.5px !important;
  height: 44px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
}

.submit-button:hover:not(:disabled) {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(142, 192, 124, 0.4) !important;
}

/* Footer text */
.footer-text {
  text-align: center;
  font-size: 13px;
  color: #bdae93;
  font-weight: 500;
  margin-top: 12px;
}

.footer-text button {
  margin: 0 2px;
}
</style>
